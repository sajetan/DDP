///******************************************************************
// * This is the main file for the Software Sessions
// *
// */
//
//#include <stdint.h>
//#include <inttypes.h>
//
//#include "common.h"
//#include <string.h>
//
//// Uncomment for Session SW1
//extern void warmup();
//
//// Uncomment for Session SW2 onwards
////#include "mp_arith.h"
////#include "montgomery.h"
////#include "asm_func.h"
//
//
//int main()
//{
//    init_platform();
//    init_performance_counters(1);
//
//    // Hello World template
//    //----------------------
////    xil_printf("Begin\n\r");
////
////START_TIMING
////
////    xil_printf("Hello World Hoya!\n\r");
////
////STOP_TIMING
////
////	xil_printf("End\n\r");
//
//    // SW1: warmup exercise
//    //----------------------
//    //warmup();
//
//	// SW2: Add
//
//	//uint32_t a[32]   = { 0xe87c0891, 0xedefbacf, 0xbe75c544, 0xb29e5e19, 0x860c5ab6, 0xf1e491df, 0xc8d459fe, 0xc811c225, 0xc4870bec, 0x60af8542, 0xec8422a1, 0xa5d7ac12, 0x5e3ad006, 0xc99e51d9, 0xfb0db87f, 0xbf7d0d0c, 0x51777580, 0x77f88d79, 0x7437df95, 0x96787032, 0x38cfc8ca, 0xba87a2b5, 0x1de9b64c, 0x56905a55, 0xdf056077, 0x02edd0b8, 0x3a8af36b, 0x631da6cb, 0xde2f29a8, 0x3982f519, 0xb51e533c, 0xcabe8494 };
//	//uint32_t b[32]   = { 0x40ea3679, 0x13b7e95f, 0x961bf864, 0xd09d0a0a, 0x72ed6a7b, 0x2ac4de5b, 0x8b9ebd95, 0xcf2cdf20, 0x9b729071, 0x39e2ff0a, 0x8f04fa45, 0x9b16fe5a, 0x79366180, 0xff9d8257, 0x1060d96f, 0x3de121ba, 0xb30033c8, 0xaf5943cd, 0x65703523, 0xb2630421, 0x6d0e6319, 0xc99c9aa4, 0x45e02225, 0xac1523c7, 0x50471970, 0xd4cddec8, 0x7489978a, 0xa698959d, 0x4230dc65, 0xba17abc1, 0x15b5dc9b, 0x9651d473 };
//	//uint32_t res[33];
//	//uint32_t size=32;
//	//START_TIMING
//	//mp_add1(&a,&b,&res,size);
//	//mp_sub(&a,&b,&res,size);
//	//STOP_TIMING
//
//
//
//	uint32_t a[32]   = { 0xa2e47eba, 0xdb5e3e7d, 0x5fd9a7cb, 0x9e7a37c3, 0x4dc37416, 0x834fe315, 0x0080dbac, 0x47280a4d, 0x722dc3dd, 0x7f0ca6f4, 0x7f0da3db, 0xfc20cbb9, 0xb749699e, 0xc5abc925, 0x8bc67669, 0x23a30d3f, 0xffe44e1c, 0xdb22d6ee, 0x5dc3d3b3, 0xfe7e980d, 0x894075d2, 0xdeabe7c4, 0x58042c3b, 0x1cc18107, 0xf0abb2e1, 0x7bd31dc0, 0x72355db9, 0xf55a0178, 0x99f5d831, 0x12ccb47a, 0x44eef089, 0x81bf5831 };
//	uint32_t b[32]   = { 0xe47d092a, 0xd7615ed9, 0xa8aff661, 0xc3d7bb8c, 0x2d22b31c, 0x5050b808, 0xb0bc44bb, 0x93e46f4f, 0xac0332e5, 0x81ad7f85, 0x23de9197, 0x4b35f0a2, 0x6303744a, 0x615740bf, 0x54ebbaef, 0xf36273c2, 0xaf0d1080, 0x4740c9d6, 0x458e6699, 0xaaa1040b, 0x614df162, 0xaf7fe30d, 0xac73e3ed, 0x49204145, 0x1653523c, 0x5ee4f3b1, 0x2b3f4339, 0x5b9a2426, 0x62e3ffb3, 0xf4c32df1, 0x94f2db82, 0x80deb209 };
//	uint32_t N[33]   = { 0xb2e52d11, 0x8f850a5f, 0x08edfb0c, 0x4f02a1ac, 0xdd070636, 0x6c59cfc8, 0x16a40db7, 0x85bba009, 0x598eba07, 0x5d0fa3cc, 0x32bc6fb5, 0x4aa27cd0, 0x0928454e, 0x027d3081, 0xd1caec35, 0xa98e4223, 0x533983de, 0x36370bb4, 0xe8b0b4c6, 0xfe3655ab, 0x27a4a51e, 0xb403c449, 0xa679cf3b, 0xc1fc4391, 0x884e5080, 0xa65d4d30, 0xcd90ed67, 0x55fcb457, 0x989d6f4c, 0x0303d70e, 0x9a09328e, 0x82260dd0, 0x0};
//	uint32_t res[33];
//	uint32_t size=32;
//	START_TIMING
//	//mp_add1(&a, &b, &res, size);
//
//	mod_add(&a,&b,&N, &res, size);
//	STOP_TIMING
//
//	xil_printf("0x");
//	for(int32_t i=32; i>=0;i--){
//		xil_printf("%08x",res[i]);
//	}
//	xil_printf("\r\n");
//    cleanup_platform();
//
//    return 0;
//}

/******************************************************************
 * This is the main file for the Software Sessions
 *
 */

#include <stdint.h>
#include <inttypes.h>

#include "common.h"


// Uncomment for Session SW2 onwards
#include "mp_arith.h"
#include "montgomery.h"
#include "asm_func.h"

void print_num(uint32_t *in, uint32_t size)
{
    int32_t i;

    xil_printf("0x");
    for (i = size-1; i >= 0; i--) {
    	xil_printf("%08x", in[i]);
    }
    xil_printf("\n\r");
}


int main()
{
    init_platform();
    init_performance_counters(1);

#if 0
	// SW2: multi-precision add/sub
	//----------------------

    //add
    xil_printf("\r\nMP_ADD");
    uint32_t a1[32]   = { 0x5fb6d493, 0xdb0ee8be, 0x704a841e, 0xd09b1f41, 0xcf4f3870, 0xa0d90b3f, 0xdd34e375, 0x02c71f50, 0xbbe0bf21, 0x4cf7dd68, 0xdc580789, 0x9ee98638, 0x708b655f, 0x09c9cf5d, 0x6cbcb152, 0x2988bd7f, 0xa2883faa, 0xbb82748d, 0x9ab7bce3, 0x5dbe293f, 0x52322bd8, 0xaeffcd83, 0xee533ae0, 0x4d4ba990, 0x90ab358f, 0x8e7ff46d, 0xc1b445a6, 0x514f1554, 0x1ae5c5ef, 0xc5dc5c9d, 0x735ad8f6, 0x86580beb };
    uint32_t b1[32]   = { 0x3cf8d180, 0xe7f5a608, 0xc4b6a195, 0xc79d0d06, 0x84b0cdf3, 0x3e5105ed, 0xf06ba2e7, 0x6e29295e, 0x7a6bf7af, 0xfbcb45ef, 0x23192140, 0x173cb903, 0xfb3b0025, 0x419641aa, 0x62c5eae8, 0xa8b835dd, 0xc1b87288, 0x3f262083, 0x27816323, 0x2f7ca6e8, 0x55dc4b30, 0xfff8ded8, 0x1ba1bdf5, 0x5d4bb174, 0x538c03cf, 0x8e853091, 0x48d23333, 0xd3ca9ba6, 0x232b5d61, 0x31758358, 0x118250c0, 0xed8c5aa0 };
	uint32_t res1[33] = { 0x0};

START_TIMING
	mp_add(a1, b1, res1,32);
STOP_TIMING
	xil_printf("\r\nA=");
	print_num(a1, 32);
	xil_printf("B=");
	print_num(b1, 32);
	xil_printf("A+B=");
	print_num(res1, 33);


    //sub
    xil_printf("\r\nMP_SUB");
    uint32_t a2[32]   = { 0xfb7345ad, 0xa972161a, 0x56e7c032, 0xab115e34, 0x54edb161, 0x090b2cd8, 0xb38355cf, 0xfc215f78, 0x02b48c2b, 0x1cf2febf, 0x05f6c7cb, 0xfecea88b, 0x79f6ccea, 0x41258aef, 0x1700ee12, 0x9cf2fab6, 0x81a88642, 0x98df2823, 0xed1154ad, 0xf1bfd75a, 0x51d6de5b, 0xfb808b5f, 0xa622f7c1, 0x5e863645, 0x50142423, 0x9f1313bc, 0xcfef6e97, 0xdd0c07bd, 0x52222e67, 0x02ec3add, 0x06f7ef59, 0x8188c6ab };
    uint32_t b2[32]   = { 0x47f1272b, 0x3f499d07, 0xdc6d6ab3, 0x67ea2462, 0xa8e7a7d8, 0xe4606bb1, 0xcdf2a51f, 0x664b9758, 0x24302a2b, 0xdb256daf, 0xe1e72364, 0x540ba351, 0xad632f6b, 0x715f7e93, 0x91ccd071, 0x11b55bc7, 0xb8444a26, 0xe93a5379, 0x5b96d885, 0xd2d93a5f, 0x2e388bb5, 0x481ae889, 0xa97cc5c6, 0x3c2a5d0a, 0xb6f2b677, 0x02dec0fe, 0xab536a25, 0x5c57a3ed, 0x372426a1, 0x5c718d06, 0x3483f275, 0x802edb99 };
	uint32_t res2[32] = { 0x0};

START_TIMING
	mp_sub(a2, b2, res2,32);
STOP_TIMING
	xil_printf("\r\nA=");
	print_num(a2, 32);
	xil_printf("B=");
	print_num(b2, 32);
	xil_printf("A-B=");
	print_num(res2, 32);

	//mod_add
	xil_printf("\r\nMOD_ADD");


	uint32_t a3[32]   = { 0xa2e47eba, 0xdb5e3e7d, 0x5fd9a7cb, 0x9e7a37c3, 0x4dc37416, 0x834fe315, 0x0080dbac, 0x47280a4d, 0x722dc3dd, 0x7f0ca6f4, 0x7f0da3db, 0xfc20cbb9, 0xb749699e, 0xc5abc925, 0x8bc67669, 0x23a30d3f, 0xffe44e1c, 0xdb22d6ee, 0x5dc3d3b3, 0xfe7e980d, 0x894075d2, 0xdeabe7c4, 0x58042c3b, 0x1cc18107, 0xf0abb2e1, 0x7bd31dc0, 0x72355db9, 0xf55a0178, 0x99f5d831, 0x12ccb47a, 0x44eef089, 0x81bf5831 };
	uint32_t b3[32]   = { 0xe47d092a, 0xd7615ed9, 0xa8aff661, 0xc3d7bb8c, 0x2d22b31c, 0x5050b808, 0xb0bc44bb, 0x93e46f4f, 0xac0332e5, 0x81ad7f85, 0x23de9197, 0x4b35f0a2, 0x6303744a, 0x615740bf, 0x54ebbaef, 0xf36273c2, 0xaf0d1080, 0x4740c9d6, 0x458e6699, 0xaaa1040b, 0x614df162, 0xaf7fe30d, 0xac73e3ed, 0x49204145, 0x1653523c, 0x5ee4f3b1, 0x2b3f4339, 0x5b9a2426, 0x62e3ffb3, 0xf4c32df1, 0x94f2db82, 0x80deb209 };
	uint32_t N3[33]   = { 0xb2e52d11, 0x8f850a5f, 0x08edfb0c, 0x4f02a1ac, 0xdd070636, 0x6c59cfc8, 0x16a40db7, 0x85bba009, 0x598eba07, 0x5d0fa3cc, 0x32bc6fb5, 0x4aa27cd0, 0x0928454e, 0x027d3081, 0xd1caec35, 0xa98e4223, 0x533983de, 0x36370bb4, 0xe8b0b4c6, 0xfe3655ab, 0x27a4a51e, 0xb403c449, 0xa679cf3b, 0xc1fc4391, 0x884e5080, 0xa65d4d30, 0xcd90ed67, 0x55fcb457, 0x989d6f4c, 0x0303d70e, 0x9a09328e, 0x82260dd0, 0x0};
	uint32_t res3[33];
	uint32_t size=32;
START_TIMING
	mod_add(a3,b3,N3, res3, size);
STOP_TIMING
	xil_printf("\r\nA=");
	print_num(a3, 32);
	xil_printf("B=");
	print_num(b3, 32);
	xil_printf("N=");
	print_num(N3, 32);
	xil_printf("(A+B)modN=");
	print_num(res3, 32);


    //mod_sub
    xil_printf("\r\nMOD_SUB");
    uint32_t a4[32]   = { 0x58dbf779, 0x575740d6, 0x22f5f4ff, 0xfee2f9aa, 0xdfd7d85e, 0x6369df65, 0xdf4779e8, 0xefaca94e, 0xa685d499, 0xe4106396, 0x5909a0d5, 0x221befa0, 0x6ebbafcf, 0x31bdd396, 0xda56c836, 0x92800aa3, 0xecda33ae, 0x93e427b6, 0x092c226b, 0x4c7a5e39, 0x4df34625, 0x5fbaa5e8, 0x2a1ae27f, 0xbf51041f, 0x77437504, 0x60e47fed, 0xc677ca07, 0x336b2407, 0x255fdade, 0xdb69e9d1, 0x7588fd3b, 0x83433479 };
    uint32_t b4[32]   = { 0xa77c16c5, 0xfa4935b5, 0xc154ec99, 0x301e2643, 0xb8b8fbdf, 0xc3c8eda2, 0x3d1a8f84, 0x534e3da3, 0x87e0e5da, 0x85c63921, 0x1a47cdf4, 0xc0c2b332, 0xe8ff04bd, 0x0c36bd23, 0xa3c96c3e, 0x308ac41b, 0x2511d7fb, 0x716a9fa9, 0x2418ed5d, 0xcc81526b, 0xc9bbff34, 0x1d8b7599, 0x7eca3082, 0xa026b29d, 0x8377813d, 0x6dba7575, 0x08b7a520, 0xcafc2de6, 0xbf13cec1, 0x4479cc1a, 0xc3ecace7, 0x80b9fa75 };
    uint32_t n4[32]   = { 0xb672e01f, 0x92e9ace2, 0x0ab61389, 0x1302d058, 0x13a6ee9b, 0xfdfb1d3f, 0x2606e136, 0x5317fd7c, 0x4583fe0a, 0xccef8929, 0xf4d2744a, 0x0f13745c, 0xf6641cbe, 0x047608d8, 0xdb7b6221, 0xa2ef20b0, 0x14e04fad, 0x3350974c, 0x0f457ad3, 0xd0ae6914, 0xad9aecc8, 0xe87a5989, 0x92705dc5, 0x8efe769e, 0xfcc342dd, 0x62c646fd, 0x3f7d0ff3, 0xd3af71f1, 0x56483141, 0x0b516398, 0x288a7cfe, 0x83b3d8eb };
    uint32_t res4[32] = { 0x0};

//#if 0
START_TIMING
	mod_sub(a4, b4, n4, res4,32);
STOP_TIMING
	xil_printf("\r\nA=");
	print_num(a4, 32);
	xil_printf("B=");
	print_num(b4, 32);
	xil_printf("N=");
	print_num(n4, 32);
	xil_printf("(A-B)modN=");
	print_num(res4, 32);
#endif

/*--------------------------------------------------------------------------------------------------------
 * Montgomery Multiplication
--------------------------------------------------------------------------------------------------------*/
    xil_printf("\r\nMontgomery Multiplication\r\n");
//    uint32_t a[32]         = { 0xa2e47eba, 0xdb5e3e7d, 0x5fd9a7cb, 0x9e7a37c3, 0x4dc37416, 0x834fe315, 0x0080dbac, 0x47280a4d, 0x722dc3dd, 0x7f0ca6f4, 0x7f0da3db, 0xfc20cbb9, 0xb749699e, 0xc5abc925, 0x8bc67669, 0x23a30d3f, 0xffe44e1c, 0xdb22d6ee, 0x5dc3d3b3, 0xfe7e980d, 0x894075d2, 0xdeabe7c4, 0x58042c3b, 0x1cc18107, 0xf0abb2e1, 0x7bd31dc0, 0x72355db9, 0xf55a0178, 0x99f5d831, 0x12ccb47a, 0x44eef089, 0x81bf5831 };
//    uint32_t b[32]         = { 0xe47d092a, 0xd7615ed9, 0xa8aff661, 0xc3d7bb8c, 0x2d22b31c, 0x5050b808, 0xb0bc44bb, 0x93e46f4f, 0xac0332e5, 0x81ad7f85, 0x23de9197, 0x4b35f0a2, 0x6303744a, 0x615740bf, 0x54ebbaef, 0xf36273c2, 0xaf0d1080, 0x4740c9d6, 0x458e6699, 0xaaa1040b, 0x614df162, 0xaf7fe30d, 0xac73e3ed, 0x49204145, 0x1653523c, 0x5ee4f3b1, 0x2b3f4339, 0x5b9a2426, 0x62e3ffb3, 0xf4c32df1, 0x94f2db82, 0x80deb209 };
//    uint32_t n[32]         = { 0xb2e52d11, 0x8f850a5f, 0x08edfb0c, 0x4f02a1ac, 0xdd070636, 0x6c59cfc8, 0x16a40db7, 0x85bba009, 0x598eba07, 0x5d0fa3cc, 0x32bc6fb5, 0x4aa27cd0, 0x0928454e, 0x027d3081, 0xd1caec35, 0xa98e4223, 0x533983de, 0x36370bb4, 0xe8b0b4c6, 0xfe3655ab, 0x27a4a51e, 0xb403c449, 0xa679cf3b, 0xc1fc4391, 0x884e5080, 0xa65d4d30, 0xcd90ed67, 0x55fcb457, 0x989d6f4c, 0x0303d70e, 0x9a09328e, 0x82260dd0 };
//    uint32_t n_prime[32]   = { 0xfb5c9c0f, 0xd3cbec85, 0x3a126c50, 0x0f85259a, 0xb93b900a, 0x89feafbe, 0x30847469, 0x0a87f885, 0x9d5bfa86, 0xec1adae0, 0x448a3dac, 0xa7194e08, 0x61c37198, 0xd5eff8a8, 0xf96efef1, 0x473d83aa, 0xe7c048dd, 0xb1893377, 0xc843e910, 0xcd3b86d2, 0x2119b9dd, 0x6caed27a, 0x7ebcc873, 0x2019cd09, 0x240e3495, 0x040754fb, 0xdfef2830, 0x32a287d7, 0x8e79f7e4, 0x3daeb7e0, 0xbeaeac00, 0x376725cd };
//    uint32_t eres[32]       = { 0x919af36d, 0x201c5a15, 0x763debb4, 0x54b92abd, 0xc3d09af8, 0x0269454a, 0x35a42e09, 0x1149a6e6, 0x381cfa5b, 0x61b91a68, 0x7180faf5, 0x8c7536c6, 0x0368f56d, 0x0ce9c2ab, 0xd6180f19, 0x0cf8b5ac, 0x62ca69e8, 0x8789e2ec, 0x080ca2ea, 0x4dea79c7, 0xf3b4499d, 0xbae3cd24, 0x148e24af, 0x83e7cc56, 0x22548763, 0x1e0f13bf, 0xc6b26d8e, 0xfc9c092d, 0x8fa70ce2, 0xb5098439, 0x9f7d1f55, 0x50a9e0c6 };

//    uint32_t a[32]         = { 0x1f0edd56, 0x8691cebb, 0xa5afdf0f, 0x3c5599dd, 0xab3747d1, 0x8e0a4e8e, 0x34605680, 0x5ea149a1, 0x264f2c8d, 0x2b4efadf, 0x519bec3f, 0x384064e2, 0x5cc5b013, 0xc2d92389, 0x8cee7307, 0x1f21efd1, 0xe39de0c0, 0x4a51e09c, 0x247e5d6a, 0x8d179b6c, 0x14fb55d6, 0x1f024a58, 0xe514a97d, 0xe5248ea5, 0xd0a19c0f, 0x1f7e0279, 0x39608eec, 0x2f82bab5, 0x76520c4e, 0x220181cd, 0xbc9cc9c2, 0x83f56658 };
//    uint32_t b[32]         = { 0xdb859839, 0x75e720f7, 0xf6b0f083, 0xcb192bc8, 0x3e8ac26f, 0x5e0e2b38, 0xb3827fd9, 0x486da9d8, 0x8a7cf84d, 0x6185f629, 0xbb3a0081, 0x8ec85c25, 0x5ebba407, 0x47222bae, 0x5216bb76, 0x182287c7, 0x914f443a, 0x8d75b5ff, 0x79512028, 0x1474a1db, 0xf4152178, 0x68f4d4f7, 0xa690cc64, 0x20038f37, 0x31a4a850, 0x4522078d, 0xe0f9dd45, 0x2f1a7026, 0xb2be48ce, 0x5b5b6579, 0xdaceff34, 0x8b0845eb };
//    uint32_t n[32]         = { 0xb242b8cf, 0xcdbb4afe, 0x80136d88, 0x2e372690, 0x4b1a746a, 0xed5059f0, 0xbb35cb54, 0xc2a962f9, 0xbf18656a, 0xe36ad376, 0x4b2c6da0, 0x754cf41b, 0x4c259bfa, 0x77572d4f, 0xdb6198e9, 0x98593a80, 0x3d451d3a, 0x1c0d5195, 0x2b8e2b80, 0x196d4e0a, 0xa1a42f7a, 0x4f9d258c, 0x00d28490, 0xc52c5829, 0xeeac176c, 0xa77796f0, 0x1f956e90, 0xede77f0a, 0x5143f44a, 0x7d94fc47, 0x2e9e8b04, 0x9ef1ed65 };
//    uint32_t n_prime[32]   = { 0x3e40b1d1, 0xed4feea0, 0x39e29bf3, 0x79640086, 0x7245e8ef, 0xffc81b2a, 0x611e1fad, 0x9b144c6c, 0xe152f301, 0x0b5b7119, 0xbdb34b13, 0x512a226d, 0xd3fe6858, 0x4b9a0c57, 0xa9543fda, 0xae3be383, 0xd1bf40c1, 0x5d5c4220, 0x7d5d8a81, 0x1e3b519e, 0xf1c06dfd, 0x163d3d02, 0x671e2f83, 0x2ff4b1e7, 0xeb56fa19, 0xa34639c4, 0xb0d41a0f, 0x94667619, 0x0bb4d6bc, 0xbf511f96, 0x436aeb87, 0x671ca04e };
//    uint32_t eres[32]       = { 0xd1185b5a, 0x5dfe1b80, 0x4e991f76, 0x2d99604b, 0x5ef4464a, 0x9c7a5943, 0x86a0e87d, 0x6d5f9762, 0x5b68ef46, 0xa40bfc5e, 0x498817be, 0x46006c6e, 0x1da099f6, 0xfeb11181, 0x9a6e644d, 0xe015a6ef, 0x440c639d, 0x60c863ad, 0x677dce9c, 0x74ad87b3, 0x63d3fa8b, 0x3e7538ae, 0x4dfbf800, 0x9b330b2f, 0x433de222, 0x4c931351, 0x5f039150, 0x07a2aafd, 0xff3f31f9, 0x3da0520c, 0x33274c15, 0x045f1fff };


//    uint32_t a[32]         = { 0xaee66c08, 0x35233dcc, 0x2a299325, 0xd9e3d338, 0x42081c8b, 0xd57a9f22, 0xb62ef3a2, 0x2a166d34, 0x1717b18b, 0xc28518b0, 0xd1213e23, 0xcc1653c1, 0x01fdee5d, 0xcb1ec76c, 0xc64ca144, 0xd0df3f61, 0x9a92d2a5, 0x126a18ef, 0xf3e38e26, 0xa02c0ac2, 0xa3c8db54, 0x99f0c2dd, 0x1b7e7556, 0x21a39126, 0xc9f5b399, 0x90bb5146, 0x08066fca, 0x73174f16, 0xdb009cd3, 0xd473ffc8, 0x16270736, 0x82e9a839 };
//    uint32_t b[32]         = { 0x855eb6f8, 0x6e9b6dff, 0xcd0636cc, 0xbf5773ea, 0xf72af8e6, 0xcbfa44fa, 0x5d58f185, 0xb35d23aa, 0xbfb8a381, 0xa7e23c00, 0x87c6781b, 0x1b1a3c5b, 0xdcc5432f, 0x7360269e, 0x2af92cef, 0xd5b62bf5, 0x9c45cf04, 0x5cfd6b26, 0xf48bb4b4, 0x9b2cb965, 0xa0579f37, 0xaef2010f, 0x955db2d8, 0xf9c705c4, 0x499c3848, 0x05408b7f, 0x0eca67a7, 0x37290375, 0x16fe438f, 0xb0ca5786, 0x26db96be, 0x84726aeb };
//    uint32_t n[32]         = { 0xe8c48a51, 0x1b8dee14, 0x862f952f, 0x8f6b8168, 0x4ea4e323, 0xd35aa574, 0x87f03b6a, 0x3bd7a5a6, 0x8d9479b6, 0xfa121d94, 0x1872cf6f, 0xbd86b870, 0xf4b9ae66, 0x08e92fb5, 0x717bc726, 0x48d634f3, 0x11a967ba, 0x7c79d4b0, 0xc516ec1f, 0x891f3089, 0x15cb661e, 0x1c8b0888, 0x631ec6e3, 0xc02484c2, 0x79b4f388, 0x0d6cba7c, 0x8b63007a, 0x95544192, 0x41425a07, 0x3ae0b97e, 0xc48ce827, 0x9fa0fb98 };
//    uint32_t n_prime[32]   = { 0x771f014f, 0xe7b6501b, 0x208998c4, 0x6494b20d, 0xe5dc4330, 0x5f367118, 0x87262076, 0x6010d23f, 0x7cd53a5f, 0x050059ae, 0x0ff8f7ba, 0x5632ee7a, 0x3061afd6, 0xa2775f9b, 0x84ca257b, 0x540baa52, 0xa789d780, 0x426850b6, 0xa418946c, 0x6dc0e89b, 0x6c2cb558, 0xca8647a6, 0x990312dd, 0x9419d08d, 0x7551f77b, 0xd855314f, 0x33590bdb, 0xe3f2cb2f, 0x20446024, 0xa95f232a, 0xee929e33, 0x17b8e73f };
//    uint32_t eres[32]       = { 0xc34f285c, 0x8dd72476, 0xd6dabaa4, 0x4981dbb8, 0x7692f817, 0x6c97e92a, 0x1d1102c4, 0xf2a4b1ce, 0x9769a3c0, 0xd98bd612, 0x9f4367be, 0x745954be, 0x9953945a, 0x2c32eaeb, 0x80a4d755, 0xb0567f1f, 0x274aa325, 0x4d363ded, 0x4f5e47d4, 0xede7bd3b, 0x69f860a9, 0x115c6838, 0xfbbbf48a, 0x256f0980, 0x7f834df5, 0xe3b1a38b, 0xba6d557a, 0x148e5717, 0x76259941, 0x3acc86da, 0xda543866, 0x9b20a57e };

    uint32_t a[32]         = { 0x0ffd20fc, 0x336877a8, 0x9107eaa3, 0xf6e856eb, 0x2eb66e22, 0xd9ffccd6, 0x4677eeb2, 0xd5250874, 0x36a34e80, 0x817676ee, 0xb7a8138e, 0xb40ff20a, 0x52e9c7b4, 0x4eacd691, 0x077c3dad, 0xf1d47508, 0x929d358c, 0xa88e28e3, 0xf15f60d8, 0xfa983af6, 0xd6729b02, 0x9389f3f8, 0x45659c72, 0x675e04e8, 0x73ef6524, 0x25e6d92a, 0x975a5eec, 0x17b9d0d0, 0x5d64b615, 0x5f225143, 0x099235c0, 0x80d60b17 };
    uint32_t b[32]         = { 0xe915fb8b, 0x80994bcf, 0xf793d789, 0x18e8eff3, 0xc3e472e9, 0x6766ae05, 0x00e4f68b, 0x533e039b, 0xa924fd10, 0xced0727f, 0xbc27114f, 0xb0bece60, 0x6f7bf509, 0x05eeaddc, 0xbb861fc9, 0x4dbf5629, 0x4cb153ec, 0xc19c3150, 0x97764d2e, 0x510d7467, 0xdb0ed4cc, 0xa25c8f33, 0x93ae30f6, 0xf3c6970f, 0xd4ae423b, 0xc7d9c310, 0x099c1fd1, 0x9cced66a, 0xfa791df9, 0xe15e3187, 0x145d43b9, 0x8da528c5 };
    uint32_t n[32]         = { 0xac6452f1, 0xfb798942, 0x0f249901, 0x5babf628, 0x7b289988, 0x9b0be47a, 0x20a8c13d, 0x30edb1b2, 0x32df5d0d, 0x2c6ac4f1, 0x61f43828, 0x5ee58557, 0x1b61dc4c, 0x772a3783, 0xb782a039, 0x1226f07d, 0x90961184, 0x3b53e965, 0x932d242f, 0x1201ed0c, 0x5ecb0bc7, 0x1ce6ab19, 0xad318f92, 0x24f30dab, 0x572370a9, 0x4861dc4f, 0xca484f1a, 0x478d60b2, 0xba834df4, 0xfa48b670, 0x854edbd8, 0xa763d5e7 };
    uint32_t n_prime[32]   = { 0xdefda1ef, 0x7c5ffb73, 0xd5a6f809, 0x0f812315, 0x2a693b12, 0xc54a47b1, 0x6e816600, 0x97551771, 0xe851f7f4, 0x739b5800, 0xa385125c, 0x5bbf7193, 0xa6e8cf36, 0x1adcf8e3, 0x8f9981f8, 0x1a833f93, 0x22d26149, 0xcc8db2fd, 0x61f127ef, 0x0c70cb1e, 0x21c009e5, 0x70cd184e, 0xb1d43815, 0x14bedb8b, 0x6d3f7b9c, 0x3624f511, 0x59c51283, 0x65352aed, 0x7b0d1201, 0x65ab7c87, 0x6b99003b, 0x6f11bf30 };
    uint32_t eres[32]       = { 0xc1a79235, 0xd15bdcd9, 0x86dd5707, 0x6a6e2ed5, 0x78d65d5b, 0x67f68e70, 0x710272e2, 0x50a864f0, 0xe401fd13, 0xa6e5230a, 0xe4a75a02, 0xf7c33347, 0x94d157f4, 0x1bc14069, 0x9245536d, 0xb25744a2, 0xac45171d, 0x19c1b2c9, 0xd4d5c639, 0xe9e6d577, 0xaad70eb9, 0x3fa67458, 0xe1ada6a5, 0xb2d16fa6, 0x70eb264e, 0x9e7980a1, 0x180ae432, 0x0650546d, 0x32a11b91, 0x4fba59bd, 0x660f196e, 0x4bf569da };


    //uint32_t a[32] = {0xf484e847, 0x4ae251f1, 0xedfa617d, 0x58ab6bf4, 0x46bf4848, 0xf67c1061, 0x8811c17a, 0x578fde16, 0x493ee595, 0x1eafc4c3, 0xc4f11a2e, 0x8cb6fba7, 0x724c03a4, 0x2e6c1dbd, 0x57ebc43d, 0x3e6ee260, 0x4089c050, 0xf0384e03, 0x7357f72c, 0x87acb658, 0x7ea2490e, 0x61069112, 0x42e3f8b9, 0x9e778cef, 0x5cdf77c7, 0x10bce41c, 0x1121beec, 0x3db59a36, 0xc34620c5, 0xc6b030ae, 0xe8fc5934, 0x63a0a0cb};
    //uint32_t b[32] = {0xfeb1b9f4, 0xe91d3bec, 0xfb09354d, 0x07f21d6d, 0x9ece9e1b, 0x18def18b, 0x4119e1e9, 0x55c85f24, 0x60ef0e23, 0x10e8ab54, 0x1e95cdcc, 0x4373912f, 0x6f42204d, 0x7126650d, 0xb61c1c8d, 0x98af9011, 0xa42c03b4, 0xd29e0870, 0x7923cb60, 0xdf87cfe5, 0xde4fffa0, 0x3ce537ca, 0x201040c6, 0x6e54b058, 0x814c53dc, 0xf16243f0, 0x57decf64, 0x8d0d4f37, 0x9b6d93e5, 0x45396d71, 0x615213c4, 0x65f89f9f};
    //uint32_t n[33] = {0x4aeeb107, 0x5d78aa98, 0x6c55dd05, 0x6f5326c9, 0xf93f738c, 0xc10fa093, 0x20478120, 0x099d6d70, 0x833d9b82, 0x1248f3ed, 0xa43ed737, 0xc1c1da45, 0x9f23e5c7, 0xb17c3598, 0xe8938df6, 0x7ae59036, 0x9f84d87b, 0xc8710dc6, 0x249ee0f8, 0x46eeae2f, 0x66a3bb9b, 0xfeef4c6b, 0xc7b55eae, 0x7951dd0c, 0x0b4391e8, 0x141ad586, 0x1a568588, 0x908293dd, 0x472c0bea, 0x8d00abfe, 0xed17377f, 0x83a01efe,0x0};
    //uint32_t n_prime[32] = {0xe7d41349, 0x0c828dcd, 0x2dc06d90, 0x318f87bf, 0x1992ba09, 0x4b1bef10, 0x011ba664, 0xe3a7d9cf, 0x44449fbd, 0x89714d34, 0x6cd49cc4, 0x49c5b99d, 0xf90435b1, 0x38f037b7, 0xba9720db, 0x9641b106, 0xbca01d2a, 0xfdb82893, 0xbd7ce9c7, 0x372823e1, 0x4901cdde, 0xaa28d457, 0xe9f78c94, 0xb6e1e5b3, 0x5a79f7a6, 0xf5212a83, 0x2b1aab45, 0xa3924b69, 0x3c63a8af, 0x12fa121d, 0x7500bea0, 0xe58878e7};
    uint32_t res[32]={0};
    uint32_t size = 32;

//    START_TIMING
//	montMul(a, b, N, n_prime, res, size);
//    STOP_TIMING

	xil_printf("\r\nA=");
	print_num(a, 32);
	xil_printf("B=");
	print_num(b, 32);
//	xil_printf("N=");
	//print_num(N, 32);
//	xil_printf("N_PRIME=");
	//print_num(n_prime, 32);
	xil_printf("eres =");
	print_num(eres, 32);
	xil_printf("\n\r");


    START_TIMING
    montMulOpt(a, b, n, n_prime, res, size);
    STOP_TIMING



	xil_printf("res =");
	print_num(res, 32);
	xil_printf("\n\r");

//	START_TIMING
	//uint32_t test[5]={1,2,3,4,5};
	uint32_t i;


//	STOP_TIMING
//	xil_printf("i=%d\n\r",i );
//	START_TIMING
//	uint32_t test_res=test1();
//	STOP_TIMING
//	xil_printf("test res =%d\n\r",test_res );

//	uint32_t aa=1;
//	uint32_t ba=2;
//	uint32_t ca=10;
//	uint32_t add= add_3(aa,  ba,  ca);
//    xil_printf("res= %d\r\n",add  );
//
//	uint32_t caa[3]={300,200,100};
//	add_10(&caa, 3);
//
//	int resc=0;
//
//	uint32_t mul= multiply( uint32_t i, uint32_t *t, uint32_t *a, uint32_t *b, uint32_t *m, uint32_t *n);
//    STOP_TIMING
//	  xil_printf("res= %d\r\n",add1  );

//	uint32_t mo[2];
//	uint32_t ho[2];
//	uint32_t ti[2];
//	mo = {1 , 2};
//	ho = {4 , 5} ;
//	uint32_t c = 0;
//	for ( uint32_t ii = 0 ; ii <2 ; ii++) {
//	uint32_t sss = opt_multiply(  mo[ii],  ho[ii],  ii, &ti, c);
//	xil_printf("sss= %d\r\n",sss  );
//	}


	cleanup_platform();


    return 0;
}
